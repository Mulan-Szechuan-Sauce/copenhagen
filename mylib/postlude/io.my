class IO:
  IOVal(worldt)

def unpackIOVal(IOVal(fun)):
  return fun

instance IO of Monad:
  # worldT: World -> (a, World)
  # f:      a -> IOVal(World -> (b, World))
  # Return: IOVal(World -> (b, world))
  def bind(IOVal(worldT), f):
    return IOVal(
      def (w):
        (a, newW) = worldT(w)
        IOVal(fun) = f(a)
        return fun(newW)
    )

def print(input):
  return IOVal((w): printStrT(input, w))

def input():
  return IOVal((w): readStrT(w))